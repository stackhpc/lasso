<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>LassoLogin</title>
<meta name="generator" content="DocBook XSL Stylesheets V1.75.1">
<link rel="home" href="index.html" title="Lasso Reference Manual">
<link rel="up" href="idff.html" title="Identity Federation Framework - ID-FF 1.2 profiles">
<link rel="prev" href="idff.html" title="Identity Federation Framework - ID-FF 1.2 profiles">
<link rel="next" href="lasso-LassoLogout.html" title="LassoLogout">
<meta name="generator" content="GTK-Doc V1.11 (XML mode)">
<link rel="stylesheet" href="style.css" type="text/css">
<link rel="chapter" href="lasso.html" title="Lasso &amp; Liberty Alliance Overview">
<link rel="reference" href="rn01.html" title="Application Programming Interface">
<link rel="chapter" href="architecture.html" title="Lasso Architecture">
<link rel="chapter" href="idff.html" title="Identity Federation Framework - ID-FF 1.2 profiles">
<link rel="chapter" href="xml-idff.html" title="Objects from ID-FF 1.2 schemas">
<link rel="chapter" href="saml2.html" title="SAML 2.0 Single Sign On profiles">
<link rel="chapter" href="xml-samlv2.html" title="Objects from SAML 2.0 schemas">
<link rel="chapter" href="idwsf.html" title="Identity Web Services Framework 1.0">
<link rel="chapter" href="xml-idwsf.html" title="Objects from ID-WSF 1.0 schemas">
<link rel="chapter" href="idwsf2.html" title="ID-WSF 2.0">
<link rel="chapter" href="xml-idwsf2.html" title="Objects from ID-WSF 2.0 schemas">
<link rel="chapter" href="soap.html" title="Object from the SOAP 1.1 schemas">
<link rel="chapter" href="xml-dsig.html" title="Object from the XML-DSIG schemas">
<link rel="chapter" href="ws-addr.html" title="Object from the WS-* schemas">
<link rel="part" href="pt01.html" title="Part II. Appendix">
<link rel="index" href="api-index.html" title="API Index">
<link rel="glossary" href="annotation-glossary.html" title="Annotation Glossary">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<table class="navigation" id="top" width="100%" summary="Navigation header" cellpadding="2" cellspacing="2">
<tr valign="middle">
<td><a accesskey="p" href="idff.html"><img src="left.png" width="24" height="24" border="0" alt="Prev"></a></td>
<td><a accesskey="u" href="idff.html"><img src="up.png" width="24" height="24" border="0" alt="Up"></a></td>
<td><a accesskey="h" href="index.html"><img src="home.png" width="24" height="24" border="0" alt="Home"></a></td>
<th width="100%" align="center">Lasso Reference Manual</th>
<td><a accesskey="n" href="lasso-LassoLogout.html"><img src="right.png" width="24" height="24" border="0" alt="Next"></a></td>
</tr>
<tr><td colspan="5" class="shortcuts">
<a href="#lasso-LassoLogin.synopsis" class="shortcut">Top</a>
                 | 
                <a href="#lasso-LassoLogin.description" class="shortcut">Description</a>
</td></tr>
</table>
<div class="refentry" title="LassoLogin">
<a name="lasso-LassoLogin"></a><div class="titlepage"></div>
<div class="refnamediv"><table width="100%"><tr>
<td valign="top">
<h2><span class="refentrytitle"><a name="lasso-LassoLogin.top_of_page"></a>LassoLogin</span></h2>
<p>LassoLogin — Single Sign-On and Federation Profile</p>
</td>
<td valign="top" align="right"></td>
</tr></table></div>
<div class="refsynopsisdiv" title="Synopsis">
<a name="lasso-LassoLogin.synopsis"></a><h2>Synopsis</h2>
<pre class="synopsis">
enum                LassoLoginProtocolProfile;
                    LassoLogin;
LassoLogin*         lasso_login_new                     (LassoServer *server);
LassoLogin*         lasso_login_new_from_dump           (LassoServer *server,
                                                         const <a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gchar"
>gchar</a> *dump);
lasso_error_t       lasso_login_accept_sso              (LassoLogin *login);
lasso_error_t       lasso_login_build_artifact_msg      (LassoLogin *login,
                                                         LassoHttpMethod http_method);
lasso_error_t       lasso_login_build_assertion         (LassoLogin *login,
                                                         const char *authenticationMethod,
                                                         const char *authenticationInstant,
                                                         const char *reauthenticateOnOrAfter,
                                                         const char *notBefore,
                                                         const char *notOnOrAfter);
lasso_error_t       lasso_login_build_authn_request_msg (LassoLogin *login);
lasso_error_t       lasso_login_build_authn_response_msg
                                                        (LassoLogin *login);
lasso_error_t       lasso_login_build_request_msg       (LassoLogin *login);
lasso_error_t       lasso_login_build_response_msg      (LassoLogin *login,
                                                         <a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gchar"
>gchar</a> *remote_providerID);
void                lasso_login_destroy                 (LassoLogin *login);
<a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gchar"
>gchar</a>*              lasso_login_dump                    (LassoLogin *login);
LassoNode *         lasso_login_get_assertion           (LassoLogin *login);
lasso_error_t       lasso_login_init_authn_request      (LassoLogin *login,
                                                         const <a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gchar"
>gchar</a> *remote_providerID,
                                                         LassoHttpMethod http_method);
lasso_error_t       lasso_login_init_idp_initiated_authn_request
                                                        (LassoLogin *login,
                                                         const <a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gchar"
>gchar</a> *remote_providerID);
lasso_error_t       lasso_login_init_request            (LassoLogin *login,
                                                         <a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gchar"
>gchar</a> *response_msg,
                                                         LassoHttpMethod response_http_method);
<a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gboolean"
>gboolean</a>            lasso_login_must_ask_for_consent    (LassoLogin *login);
<a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gboolean"
>gboolean</a>            lasso_login_must_authenticate       (LassoLogin *login);
lasso_error_t       lasso_login_process_authn_request_msg
                                                        (LassoLogin *login,
                                                         const char *authn_request_msg);
lasso_error_t       lasso_login_process_authn_response_msg
                                                        (LassoLogin *login,
                                                         <a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gchar"
>gchar</a> *authn_response_msg);
lasso_error_t       lasso_login_process_paos_response_msg
                                                        (LassoLogin *login,
                                                         <a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gchar"
>gchar</a> *msg);
lasso_error_t       lasso_login_process_request_msg     (LassoLogin *login,
                                                         <a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gchar"
>gchar</a> *request_msg);
lasso_error_t       lasso_login_process_response_msg    (LassoLogin *login,
                                                         <a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gchar"
>gchar</a> *response_msg);
lasso_error_t       lasso_login_validate_request_msg    (LassoLogin *login,
                                                         <a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gboolean"
>gboolean</a> authentication_result,
                                                         <a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gboolean"
>gboolean</a> is_consent_obtained);
</pre>
</div>
<div class="refsect1" title="Description">
<a name="lasso-LassoLogin.description"></a><h2>Description</h2>
<p>
The Single Sign On process allows a user to log in once to an identity
provider (IdP), and to be then transparently loged in to the required
service providers (SP) belonging to the IP "circle of trust".  Subordinating
different identities of the same user within a circle of trust to a unique
IP is called "Identity Federation".  The liberty Alliance specifications
allows, thanks to this federation, strong and unique authentication coupled
with control by the user of his personal informations. The explicit user
agreement is necessary before proceeding to Identity Federation.
</p>
<p>
</p>
<p>
The service provider must implement the following process:
</p>
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>creating an authentication request with
 <code class="function">lasso_login_init_authn_request()</code>;</p></li>
<li class="listitem"><p>sending it to the identity provider with
 <code class="function">lasso_login_build_authn_request_msg()</code>;</p></li>
<li class="listitem">
<p>receiving and processing the answer:
   </p>
<div class="itemizedlist"><ul class="itemizedlist" type="circle">
<li class="listitem">either an authentication response with
     <code class="function">lasso_login_process_authn_response_msg()</code>
</li>
<li class="listitem">or an artifact with <code class="function">lasso_login_init_request()</code> then sending the
     request to the IdP with <code class="function">lasso_login_build_request_msg()</code> and processing the
     new answer with <code class="function">lasso_login_process_response_msg()</code>.</li>
</ul></div>
<p>
   </p>
</li>
</ul></div>
<p>
</p>
<p>
</p>
<p>
</p>
<p>Our first example shows how to initiate a request toward an ID-FF 1.2 or SAML 2.0 identity
provider. It supposes that we already initialized a <span class="type">LassoServer</span> object with the metadatas or our
provider (and its private key if we want to sign the request), and that we added the metadatas of
the targetted IdP with the method <code class="function">lasso_server_add_provider()</code>.  </p>
<p>
</p>
<p>
</p>
<div class="example">
<a name="id2692415"></a><p class="title"><b>Example 1. Service Provider Login URL</b></p>
<div class="example-contents"><pre class="programlisting">
LassoLogin *login;
int rc; // hold return codes

login = lasso_login_new(server);
rc = lasso_login_init_authn_request(login, "http://identity-provider-id/",
                LASSO_HTTP_METHOD_REDIRECT);
if (rc != 0) {
  ... // handle errors, most of them are related to bad initialization
}

// customize AuthnRequest
// protocolProfile is the protocolProfile of the provider http://identity-provider-id/
if (protocolProfile == LASSO_LIBERTY_1_2) {
        LassoLibAuthnRequest *request = LASSO_LIB_AUTHN_REQUEST(LASSO_PROFILE(login)-&gt;request);
        request-&gt;NameIDPolicy = strdup(LASSO_LIB_NAMEID_POLICY_TYPE_FEDERATED);
        request-&gt;ForceAuthn = TRUE;
        request-&gt;IsPassive = FALSE;
        // tell the IdP how to return the response
        request-&gt;ProtocolProfile = strdup(LASSO_LIB_PROTOCOL_PROFILE_BRWS_ART);
} else if (protocolProfile == LASSO_SAML_2_0) {
        LassoSamlp2AuthnRequest *request = LASSO_SAMLP2_AUTHN_REQUEST(LASSO_PROFILE(login)-&gt;request);
        if (request-&gt;NameIDPolicy-&gt;Format) {
                g_free(request-&gt;NameIDPolicy-&gt;Format);
        }
        request-&gt;NameIDPolicy-&gt;Format = g_strdup(LASSO_NAME_IDENTIFIER_FORMAT_PERSISTENT);
        // Allow creation of new federation
        // 
        request-&gt;NameIDPolicy-&gt;AllowCreate = 1;
        request-&gt;ForceAuthn = TRUE;
        request-&gt;IsPassive = FALSE;
        // tell the IdP how to return the response
        if (request-&gt;ProtocolBinding) {
                 g_free(request-&gt;ProtocolBinding);
        }
        // here we expect an artifact response, it could be post, redirect or PAOS.
        request-&gt;ProtocolBinding = g_strdup(LASSO_SAML2_METADATA_BINDING_ARTIFACT);
   }
// Lasso will choose whether to sign the request by looking at the IdP
// metadatas and at our metadatas, but you can always force him to sign or to
// not sign using the method lasso_profile_set_signature_hint() on the
// LassoLogin object.

rc = lasso_login_build_authn_request_msg(login);
if (rc != 0) {
      .... // handle errors
      // could be that the requested binding (POST, Redirect, etc..) is not supported (LASSO_PROFILE_ERROR_UNSUPPORTED_PROFILE)
      // or that we could not sign the request (LASSO_PROFILE_ERROR_BUILDING_QUERY_FAILED).
}

// redirect user to identity provider
   // we chose the Redirect binding, so we have to generate a redirect HTTP response to the URL returned by Lasso
printf("Location: %s\n\nRedirected to IdP\n", LASSO_PROFILE(login)-&gt;msg_url);
</pre></div>
</div>
<p><br class="example-break">
</p>
<p>
</p>
<p>Next example shows how to receive the response from the identity
provider for ID-FF 1.2.</p>
<p>
</p>
<p>
</p>
<div class="example">
<a name="id2692480"></a><p class="title"><b>Example 2. Service Provider Assertion Consumer Service URL for ID-FF 1.2</b></p>
<div class="example-contents"><pre class="programlisting">
LassoLogin *login;
char *request_method = getenv("REQUEST_METHOD");
char *artifact_msg = NULL, *lares = NULL, *lareq = NULL;
char *name_identifier;
lassoHttpMethod method;
int rc = 0;

login = lasso_login_new(server);
if (strcmp(request_method, "GET") == 0) {
        artifact_msg = getenv("QUERY_STRING");
        method = LASSO_HTTP_METHOD_REDIRECT;
} else {
        // read submitted form; if it has a LAREQ field, put it in lareq,
        // if it has a LARES field, put it in lares
        if (lareq) {
                artifact_msg = lareq;
        } else if (lares) {
                response_msg = lares;
        } else {
                // bail out
        }
        method = LASSO_HTTP_METHOD_POST;
}

if (artifact_msg) {
        // we received an artifact response,
        // it means we did not really receive the response,
        // only a token to redeem the real response from the identity
        // provider through a SOAP resolution call
        rc = lasso_login_init_request(login, artifact_msg, method);
        if (rc != 0) {
                  ... // handle errors
                  // there is usually no error at this step, only
                  // if the IdP response is malformed
        }
        rc = lasso_login_build_request_msg(login);
        if (rc != 0) {
                  ... // handle errors
                  // as for AuthnRequest generation, it generally is caused
                  // by a bad initialization like an impossibility to load
                  // the private key.
        }
        // makes a SOAP call, soap_call is NOT a Lasso function
        soap_answer_msg = soap_call(LASSO_PROFILE(login)-&gt;msg_url,
                        LASSO_PROFILE(login)-&gt;msg_body);
        rc = lasso_login_process_response_msg(login, soap_answer_msg);
        if (rc != 0) {
                  ... // handle errors
                  // here you can know if the IdP refused the request, 
        }
} else if (response_msg) {
        lasso_login_process_authn_response_msg(login, response_msg);
}

// looks up name_identifier in local file, database, whatever and gets back
// two things: identity_dump and session_dump
name_identifier = LASSO_PROFILE(login)-&gt;nameIdentifier
lasso_profile_set_identity_from_dump(LASSO_PROFILE(login), identity_dump);
lasso_profile_set_session_from_dump(LASSO_PROFILE(login), session_dump);

lasso_login_accept_sso(login);

if (lasso_profile_is_identity_dirty(LASSO_PROFILE(login))) {
        LassoIdentity *identity;
        char *identity_dump;
        identity = lasso_profile_get_identity(LASSO_PROFILE(login));
        identity_dump = lasso_identity_dump(identity);
        // record identity_dump in file, database...
}

if (lasso_profile_is_session_dirty(LASSO_PROFILE(login))) {
        LassoSession *session;
        char *session_dump;
        session = lasso_profile_get_session(LASSO_PROFILE(login));
        session_dump = lasso_session_dump(session);
        // record session_dump in file, database...
}

// redirect user anywhere
printf("Location: %s\n\nRedirected to site root\n", login-&gt;msg_url);
</pre></div>
</div>
<p><br class="example-break">
</p>
<p>
</p>
<p>The implement an IdP you must create a single sign-on service endpoint, the needed APIs for
this are <code class="function">lasso_login_process_authn_request_msg()</code>, <code class="function">lasso_login_validate_request_msg()</code>,
<code class="function">lasso_login_build_assertion()</code>, <code class="function">lasso_login_build_authn_response_msg()</code> and
<code class="function">lasso_login_build_artifact_msg()</code>. You will have to chose between
<code class="function">lasso_login_build_authn_response_msg()</code> and <code class="function">lasso_login_build_artifact_msg()</code> depending on the
requested protocol for the response by the service provider</p>
<p>
</p>
<p>
</p>
<div class="example">
<a name="id2692613"></a><p class="title"><b>Example 3. Identity provider single sign-on service</b></p>
<div class="example-contents"><pre class="programlisting">
LassoLogin *login;
char *request_method = getenv("REQUEST_METHOD");
char *artifact_msg = NULL, *lares = NULL, *lareq = NULL;
char *name_identifier;
lassoHttpMethod method;
int rc = 0;

login = lasso_login_new(server);
if (strcmp(request_method, 'GET')) { // AuthnRequest send with the HTTP-Redirect binding
    //
    lasso_profile_set_signature_verify_hint(LASSO_PROFILE(login),
            LASSO_PROFILE_SIGNATURE_VERIFY_HINT_FORCE);
    rc = lasso_process_authn_request_msg(login, getenv("QUERY_STRING"));
    if (rc != 0) {
        // handle errors
    }


} else {

</pre></div>
</div>
<p><br class="example-break"></p>
</div>
<div class="refsect1" title="Details">
<a name="lasso-LassoLogin.details"></a><h2>Details</h2>
<div class="refsect2" title="enum LassoLoginProtocolProfile">
<a name="LassoLoginProtocolProfile"></a><h3>enum LassoLoginProtocolProfile</h3>
<pre class="programlisting">typedef enum {
	LASSO_LOGIN_PROTOCOL_PROFILE_BRWS_ART = 1,
	LASSO_LOGIN_PROTOCOL_PROFILE_BRWS_POST,
	LASSO_LOGIN_PROTOCOL_PROFILE_BRWS_LECP,
	LASSO_LOGIN_PROTOCOL_PROFILE_REDIRECT,
} LassoLoginProtocolProfile;
</pre>
<p>
Identifies the four possible profiles for Single Sign-On and Federation. It defined how the
response to authentication request will transmitted to the service provider.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><a name="LASSO-LOGIN-PROTOCOL-PROFILE-BRWS-ART--CAPS"></a><span class="term"><code class="literal">LASSO_LOGIN_PROTOCOL_PROFILE_BRWS_ART</code></span></p></td>
<td> response is transmitted through a redirect request with
an artifact, followed by an artifact resolution request by the service provider.
</td>
</tr>
<tr>
<td><p><a name="LASSO-LOGIN-PROTOCOL-PROFILE-BRWS-POST--CAPS"></a><span class="term"><code class="literal">LASSO_LOGIN_PROTOCOL_PROFILE_BRWS_POST</code></span></p></td>
<td> response is transmitted through a POST.
</td>
</tr>
<tr>
<td><p><a name="LASSO-LOGIN-PROTOCOL-PROFILE-BRWS-LECP--CAPS"></a><span class="term"><code class="literal">LASSO_LOGIN_PROTOCOL_PROFILE_BRWS_LECP</code></span></p></td>
<td> response is transmitted in a PAOS response (see
<span class="type">LassoLecp</span>).
</td>
</tr>
<tr>
<td><p><a name="LASSO-LOGIN-PROTOCOL-PROFILE-REDIRECT--CAPS"></a><span class="term"><code class="literal">LASSO_LOGIN_PROTOCOL_PROFILE_REDIRECT</code></span></p></td>
<td> response is transmitted through a redirect.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" title="LassoLogin">
<a name="LassoLogin"></a><h3>LassoLogin</h3>
<pre class="programlisting">typedef struct {
	LassoProfile parent;

	LassoLoginProtocolProfile protocolProfile;
	gchar *assertionArtifact;
} LassoLogin;
</pre>
<p>
Single sign-on profile for the current transaction; possibly an
assertionArtifact to be used by the service provider in its
"assertionConsumerServiceURL" and the assertion created or received for the
principal.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term">LassoProfile <em class="structfield"><code>parent</code></em>;</span></p></td>
<td></td>
</tr>
<tr>
<td><p><span class="term">LassoLoginProtocolProfile <em class="structfield"><code>protocolProfile</code></em>;</span></p></td>
<td> the kind of binding used for this authentication request.
</td>
</tr>
<tr>
<td><p><span class="term"><a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gchar"
>gchar</a> *<em class="structfield"><code>assertionArtifact</code></em>;</span></p></td>
<td> a string representing the artifact received through an artifact resolution.
request
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" title="lasso_login_new ()">
<a name="lasso-login-new"></a><h3>lasso_login_new ()</h3>
<pre class="programlisting">LassoLogin*         lasso_login_new                     (LassoServer *server);</pre>
<p>
Creates a new <span class="type">LassoLogin</span>.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td> the <span class="type">LassoServer</span>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> a newly created <span class="type">LassoLogin</span> object; or NULL if an error
    occured
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" title="lasso_login_new_from_dump ()">
<a name="lasso-login-new-from-dump"></a><h3>lasso_login_new_from_dump ()</h3>
<pre class="programlisting">LassoLogin*         lasso_login_new_from_dump           (LassoServer *server,
                                                         const <a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gchar"
>gchar</a> *dump);</pre>
<p>
Restores the <em class="parameter"><code>dump</code></em> to a new <span class="type">LassoLogin</span>.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>server</code></em> :</span></p></td>
<td> the <span class="type">LassoServer</span>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>dump</code></em> :</span></p></td>
<td> XML login dump
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> a newly created <span class="type">LassoLogin</span>; or NULL if an error occured.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" title="lasso_login_accept_sso ()">
<a name="lasso-login-accept-sso"></a><h3>lasso_login_accept_sso ()</h3>
<pre class="programlisting">lasso_error_t       lasso_login_accept_sso              (LassoLogin *login);</pre>
<p>
Gets the assertion of the response and adds it to the <span class="type">LassoSession</span> object.
Builds a federation with the 2 name identifiers of the assertion
and adds it into the identity.
If the session or the identity are NULL, they are created.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>login</code></em> :</span></p></td>
<td> a <span class="type">LassoLogin</span>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> 0 on success; or
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>
<span class="type">LASSO_PARAM_ERROR_BAD_TYPE_OR_NULL_OBJ</span> if login is not a <span class="type">LassoLogin</span> object,
</p></li>
<li class="listitem"><p>
<span class="type">LASSO_PROFILE_ERROR_MISSING_RESPONSE</span> if no response is present in the login profile object;
usually because no call to lasso_login_process_authn_response_msg was done;
</p></li>
<li class="listitem"><p>
<span class="type">LASSO_PROFILE_ERROR_MISSING_ASSERTION</span> if the response does not contain an assertion,
</p></li>
<li class="listitem"><p>
<span class="type">LASSO_PROFILE_ERROR_NAME_IDENTIFIER_NOT_FOUND</span> if the assertion does not contain a NameID element,
</p></li>
<li class="listitem"><p>
<span class="type">LASSO_PROFILE_ERROR_MISSING_NAME_IDENTIFIER</span> same as
<span class="type">LASSO_PROFILE_ERROR_NAME_IDENTIFIER_NOT_FOUND</span>,
</p></li>
<li class="listitem"><p>
<span class="type">LASSO_LOGIN_ERROR_ASSERTION_REPLAY</span> if the assertion has already been used.
</p></li>
</ul></div>
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" title="lasso_login_build_artifact_msg ()">
<a name="lasso-login-build-artifact-msg"></a><h3>lasso_login_build_artifact_msg ()</h3>
<pre class="programlisting">lasso_error_t       lasso_login_build_artifact_msg      (LassoLogin *login,
                                                         LassoHttpMethod http_method);</pre>
<p>
Builds a SAML artifact. Depending of the HTTP method, the data for the sending of
the artifact are stored in <em class="parameter"><code>msg_url</code></em> (REDIRECT) or <em class="parameter"><code>msg_url</code></em>, <em class="parameter"><code>msg_body</code></em> and
<em class="parameter"><code>msg_relayState</code></em> (POST).</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>login</code></em> :</span></p></td>
<td> a <span class="type">LassoLogin</span>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>http_method</code></em> :</span></p></td>
<td> the HTTP method to send the artifact (REDIRECT or POST)
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> 0 on success; or
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>
LASSO_PARAM_ERROR_BAD_TYPE_OR_NULL_OBJ if login is not a <span class="type">LassoLogin</span> object,
</p></li>
<li class="listitem"><p>
LASSO_PROFILE_ERROR_MISSING_REMOTE_PROVIDERID if no remote provider ID was setup in the login
profile object, it's usually done by lasso_login_process_authn_request_msg,
</p></li>
<li class="listitem"><p>
LASSO_PROFILE_ERROR_INVALID_HTTP_METHOD if the HTTP method is neither LASSO_HTTP_METHOD_REDIRECT
or LASSO_HTTP_METHOD_POST (ID-FF 1.2 case) or neither LASSO_HTTP_METHOD_ARTIFACT_GET or
LASSO_HTTP_METHOD_ARTIFACT_POST (SAML 2.0 case) for SAML 2.0),
</p></li>
<li class="listitem"><p>
LASSO_PROFILE_ERROR_INVALID_PROTOCOLPROFILE if the current protocolProfile is not
</p></li>
<li class="listitem"><p>
LASSO_LOGIN_PROTOCOL_PROFILE_BRWS_ART (only for ID-FF 1.2),
</p></li>
<li class="listitem"><p>
LASSO_SERVER_ERROR_PROVIDER_NOT_FOUND if the remote provider is not known to our server object
which impeach us to find a service endpoint,
</p></li>
<li class="listitem"><p>
LASSO_PROFILE_ERROR_MISSING_RESPONSE if the response object is missing,
</p></li>
<li class="listitem"><p>
LASSO_PROFILE_ERROR_MISSING_STATUS_CODE if the response object is missing a status code,
</p></li>
</ul></div>

</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" title="lasso_login_build_assertion ()">
<a name="lasso-login-build-assertion"></a><h3>lasso_login_build_assertion ()</h3>
<pre class="programlisting">lasso_error_t       lasso_login_build_assertion         (LassoLogin *login,
                                                         const char *authenticationMethod,
                                                         const char *authenticationInstant,
                                                         const char *reauthenticateOnOrAfter,
                                                         const char *notBefore,
                                                         const char *notOnOrAfter);</pre>
<p>
Builds an assertion and stores it in profile session.
<em class="parameter"><code>authenticationInstant</code></em>, reauthenticateOnOrAfter, <em class="parameter"><code>notBefore</code></em> and
<em class="parameter"><code>notOnOrAfter</code></em> may be NULL.  If <em class="parameter"><code>authenticationInstant</code></em> is NULL, the current
time will be used.  Time values must be encoded in UTC.
</p>
<p>
Construct the authentication assertion for the response. It must be called after validating the
request using <code class="function">lasso_login_validate_request_msg()</code>. The created assertion is accessed using
<code class="function">lasso_login_get_assertion()</code>.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>login</code></em> :</span></p></td>
<td> a <span class="type">LassoLogin</span>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticationMethod</code></em> :</span></p></td>
<td> the authentication method
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authenticationInstant</code></em> :</span></p></td>
<td> the time at which the authentication took place
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>notBefore</code></em> :</span></p></td>
<td> the earliest time instant at which the assertion is valid
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>notOnOrAfter</code></em> :</span></p></td>
<td> the time instant at which the assertion has expired
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> 0 on success; or
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>
<span class="type">LASSO_PARAM_ERROR_BAD_TYPE_OR_NULL_OBJ</span> if login is not a <span class="type">LassoLogin</span> object,
</p></li>
<li class="listitem"><p>
<span class="type">LASSO_PROFILE_ERROR_IDENTITY_NOT_FOUND</span> if no identity object was found in the login profile object.
</p></li>
<li class="listitem"><p>
<span class="type">LASSO_PROFILE_ERROR_MISSING_RESPONSE</span> if no response object is present ( it is normally initialized
by <code class="function">lasso_login_process_authn_request_msg()</code> )
</p></li>
<li class="listitem"><p>
<span class="type">LASSO_PROFILE_ERROR_FEDERATION_NOT_FOUND</span> if a <span class="type">LASSO_SAML2_NAME_IDENTIFIER_FORMAT_PERSISTENT</span> or <span class="type">LASSO_SAML2_NAME_IDENTIFIER_FORMAT_ENCRYPTED</span> NameID format is asked and no corresponding federation was found in the <span class="type">LassoIdentity</span> object,
</p></li>
<li class="listitem"><p>
<span class="type">LASSO_SERVER_ERROR_PROVIDER_NOT_FOUND</span> if encryption is needed and the request issuing provider is unknown (it as not been registered in the <span class="type">LassoServer</span> object),
</p></li>
<li class="listitem"><p>
<span class="type">LASSO_DS_ERROR_ENCRYPTION_FAILED</span> if encryption is needed but it failed,
</p></li>
</ul></div>

</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" title="lasso_login_build_authn_request_msg ()">
<a name="lasso-login-build-authn-request-msg"></a><h3>lasso_login_build_authn_request_msg ()</h3>
<pre class="programlisting">lasso_error_t       lasso_login_build_authn_request_msg (LassoLogin *login);</pre>
<p>
Converts profile authentication request (<em class="parameter"><code>request</code></em> member) into a Liberty message, either an URL
in HTTP-Redirect profile or an URL and a field value in Browser-POST (form) profile.
</p>
<p>
The URL is set into the <em class="parameter"><code>msg_url</code></em> member and the eventual field value (LAREQ) is set into the
<em class="parameter"><code>msg_body</code></em> member.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>login</code></em> :</span></p></td>
<td> a <span class="type">LassoLogin</span>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> 0 on success; or
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>
<span class="type">LASSO_PARAM_ERROR_BAD_TYPE_OR_NULL_OBJ</span> if login is not a <span class="type">LassoLogin</span> object,
</p></li>
<li class="listitem"><p>
<span class="type">LASSO_PROFILE_ERROR_MISSING_REMOTE_PROVIDERID</span> if not remote provider ID was setup&amp;160;- it usually
means that <code class="function">lasso_login_init_request()</code> was not called before,
</p></li>
<li class="listitem"><p>
<span class="type">LASSO_SERVER_ERROR_PROVIDER_NOT_FOUND</span> if the remote provider ID is not registered in the server
object,
</p></li>
<li class="listitem"><p>
<span class="type">LASSO_PROFILE_ERROR_UNSUPPORTED_PROFILE</span> if the SSO profile is not supported by the targeted
provider,
</p></li>
<li class="listitem"><p>
<span class="type">LASSO_PROFILE_ERROR_BUILDING_QUERY_FAILED</span> if the building of the query part of the redirect URL
or of the body of the POST content failed&amp;160;- it only happens with the <span class="type">LASSO_HTTP_METHOD_REDIRECT</span>,
<span class="type">LASSO_HTTP_METHOD_POST</span>, <span class="type">LASSO_HTTP_METHOD_ARTIFACT_GET</span> and
<span class="type">LASSO_HTTP_METHOD_ARTIFACT_POST</span> bindings&amp;160;-,
</p></li>
<li class="listitem"><p>
<span class="type">LASSO_PROFILE_ERROR_UNKNOWN_PROFILE_URL</span> if the metadata of the remote provider does not contain
an url for the SSO profile,
</p></li>
<li class="listitem"><p>
<span class="type">LASSO_PROFILE_ERROR_INVALID_REQUEST</span> if the request object is not of the needed type, is usually
means that <code class="function">lasso_login_init_request()</code> was not called before,
</p></li>
<li class="listitem"><p>
<span class="type">LASSO_PROFILE_MISSING_REQUEST</span> if the request object is missing,
</p></li>
<li class="listitem"><p>
<span class="type">LASSO_PROFILE_ERROR_INVALID_HTTP_METHOD</span> if the current setted <em class="parameter"><code>http_method</code></em> on the <span class="type">LassoLogin</span>
object is invalid.
</p></li>
</ul></div>
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" title="lasso_login_build_authn_response_msg ()">
<a name="lasso-login-build-authn-response-msg"></a><h3>lasso_login_build_authn_response_msg ()</h3>
<pre class="programlisting">lasso_error_t       lasso_login_build_authn_response_msg
                                                        (LassoLogin *login);</pre>
<p>
Converts profile authentication response (<em class="parameter"><code>response</code></em> member) into a Liberty
message.
</p>
<p>
The URL is set into the <em class="parameter"><code>msg_url</code></em> member and the field value (LARES) is set
into the <em class="parameter"><code>msg_body</code></em> member.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>login</code></em> :</span></p></td>
<td> a <span class="type">LassoLogin</span>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> 0 on success; or
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>
LASSO_PARAM_ERROR_BAD_TYPE_OR_NULL_OBJ if login is not a <span class="type">LassoLogin</span> object,
</p></li>
<li class="listitem"><p>
LASSO_PROFILE_ERROR_INVALID_PROTOCOLPROFILE if the current protocol profile is not
</p></li>
<li class="listitem"><p>
LASSO_LOGIN_PROTOCOL_PROFILE_BRWS_POST or LASSO_LOGIN_PROTOCOL_PROFILE_BRWS_LECP,
</p></li>
<li class="listitem"><p>
LASSO_SERVER_ERROR_PROVIDER_NOT_FOUND if the remote provider ID is not registered in the server
object,
</p></li>
<li class="listitem"><p>
LASSO_PROFILE_ERROR_UNKNOWN_PROFILE_URL if the metadata of the remote provider does not contain
an URL for the assertion consuming service,
</p></li>
<li class="listitem"><p>
LASSO_PROFILE_ERROR_MISSING_SERVER the server object is needed to sign a message and it is
missing,
</p></li>
<li class="listitem"><p>
LASSO_DS_ERROR_PRIVATE_KEY_LOAD_FAILED the private key for signing could not be found,
</p></li>
<li class="listitem"><p>
LASSO_PROFILE_ERROR_MISSING_RESPONSE if the response object is missing,
</p></li>
<li class="listitem"><p>
LASSO_PROFILE_ERROR_UNSUPPORTED_PROFILE if the SSO profile is not supported by the targeted
provider,
</p></li>
<li class="listitem"><p>
LASSO_PROFILE_BUILDING_QUERY_FAILED if using <span class="type">LASSO_HTTP_METHOD_REDIRECT</span> building of the redirect
URL failed,
</p></li>
<li class="listitem"><p>
LASSO_PROFILE_BUILDING_MSG_FAILED if using <span class="type">LASSO_HTTP_METHOD_POST</span>, <span class="type">LASSO_HTTP_METHOD_SOAP</span> or
<span class="type">LASSO_HTTP_METHOD_PAOS</span> and building the <em class="parameter"><code>msg_body</code></em> failed.
</p></li>
</ul></div>

</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" title="lasso_login_build_request_msg ()">
<a name="lasso-login-build-request-msg"></a><h3>lasso_login_build_request_msg ()</h3>
<pre class="programlisting">lasso_error_t       lasso_login_build_request_msg       (LassoLogin *login);</pre>
<p>
Produce a SOAP Artifact Resolve message. It must follows a call to
<code class="function">lasso_login_init_request()</code> on the artifact message.
Converts  artifact request into a Liberty SOAP message.
</p>
<p>
The URL is set into the <em class="parameter"><code>msg_url</code></em> member and the SOAP message is set into the
<em class="parameter"><code>msg_body</code></em> member. You should POST the <em class="parameter"><code>msg_body</code></em> to the <em class="parameter"><code>msg_url</code></em> afterward.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>login</code></em> :</span></p></td>
<td> a <span class="type">LassoLogin</span>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> 0 on success; or
LASSO_PARAM_ERROR_BAD_TYPE_OR_NULL_OBJ if login is not a <span class="type">LassoLogin</span> object,
LASSO_PROFILE_ERROR_MISSING_REMOTE_PROVIDERID if not remote provider ID was setup -- it usually
means that lasso_login_init_request was not called before,
LASSO_SERVER_ERROR_PROVIDER_NOT_FOUND if the remote provider ID is not registered in the server
object.

</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" title="lasso_login_build_response_msg ()">
<a name="lasso-login-build-response-msg"></a><h3>lasso_login_build_response_msg ()</h3>
<pre class="programlisting">lasso_error_t       lasso_login_build_response_msg      (LassoLogin *login,
                                                         <a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gchar"
>gchar</a> *remote_providerID);</pre>
<p>
Converts profile assertion response (<em class="parameter"><code>response</code></em> member) into a Liberty SOAP
messageresponse message.
</p>
<p>
The URL is set into the <em class="parameter"><code>msg_url</code></em> member and the SOAP message is set into the
<em class="parameter"><code>msg_body</code></em> member.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>login</code></em> :</span></p></td>
<td> a <span class="type">LassoLogin</span>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>remote_providerID</code></em> :</span></p></td>
<td> service provider ID
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> 0 on success; or a negative value otherwise.
LASSO_PARAM_ERROR_BAD_TYPE_OR_NULL_OBJ if login is not a <span class="type">LassoLogin</span> object,
LASSO_PROFILE_ERROR_SESSION_NOT_FOUND if no session object was found in the login profile object
-- it should be created by <code class="function">lasso_login_build_assertion()</code> if you did not set it manually before
 calling <code class="function">lasso_login_build_assertion()</code>.

</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" title="lasso_login_destroy ()">
<a name="lasso-login-destroy"></a><h3>lasso_login_destroy ()</h3>
<pre class="programlisting">void                lasso_login_destroy                 (LassoLogin *login);</pre>
<p>
Destroys a <span class="type">LassoLogin</span> object.
</p>
<p>
<em class="parameter"><code>Deprecated</code></em>: Since <span class="type">2</span>.2.1, use <a
href="http://library.gnome.org/devel/gobject/unstable/gobject-The-Base-Object-Type.html#g-object-unref"
><code class="function">g_object_unref()</code></a> instead.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody><tr>
<td><p><span class="term"><em class="parameter"><code>login</code></em> :</span></p></td>
<td> a <span class="type">LassoLogin</span>
</td>
</tr></tbody>
</table></div>
</div>
<hr>
<div class="refsect2" title="lasso_login_dump ()">
<a name="lasso-login-dump"></a><h3>lasso_login_dump ()</h3>
<pre class="programlisting"><a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gchar"
>gchar</a>*              lasso_login_dump                    (LassoLogin *login);</pre>
<p>
Dumps <em class="parameter"><code>login</code></em> content to an XML string.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>login</code></em> :</span></p></td>
<td> a <span class="type">LassoLogin</span>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> the dump string.  It must be freed by the caller.. <a href="http://foldoc.doc.ic.ac.uk/foldoc/foldoc.cgi?query=transfer"><span class="acronym">transfer</span></a> full. </td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" title="lasso_login_get_assertion ()">
<a name="lasso-login-get-assertion"></a><h3>lasso_login_get_assertion ()</h3>
<pre class="programlisting">LassoNode *         lasso_login_get_assertion           (LassoLogin *login);</pre>
<p>
Return the last build assertion.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>login</code></em> :</span></p></td>
<td> a <span class="type">LassoLogin</span> object
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> a <span class="type">LassoNode</span> representing the build assertion (generally a <span class="type">LassoSamlAssertion</span> when
using ID-FF 1.2 or a <span class="type">LassoSaml2Assertion</span> when using SAML 2.0)
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" title="lasso_login_init_authn_request ()">
<a name="lasso-login-init-authn-request"></a><h3>lasso_login_init_authn_request ()</h3>
<pre class="programlisting">lasso_error_t       lasso_login_init_authn_request      (LassoLogin *login,
                                                         const <a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gchar"
>gchar</a> *remote_providerID,
                                                         LassoHttpMethod http_method);</pre>
<p>
</p>
<p>Initializes a new AuthnRequest from current service provider to remote
identity provider specified in <em class="parameter"><code>remote_providerID</code></em> (if NULL the first known
identity provider is used).</p>
<p>
</p>
<p>
</p>
<p>For ID-FF 1.2 the default NameIDPolicy in an AuthnRequest is None, which imply that a
federation must already exist on the IdP side.</p>
<p>
</p>
<p>
</p>
<p>For SAML 2.0 the default NameIDPolicy is the first listed in the metadatas of the current
provider, or if none is specified, Transient, which ask the IdP to give a one-time
federation</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>login</code></em> :</span></p></td>
<td> a <span class="type">LassoLogin</span>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>remote_providerID:(allow-none)</code></em> :</span></p></td>
<td> the providerID of the identity provider (may be NULL)
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>http_method</code></em> :</span></p></td>
<td> HTTP method to use for request transmission. <acronym title="Default parameter value (for in case the shadows-to function has less parameters)."><span class="acronym">default</span></acronym> LASSO_HTTP_METHOD_REDIRECT. </td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> 0 on success; or <div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>LASSO_PARAM_ERROR_BAD_TYPE_OR_NULL_OBJ if login is not a <span class="type">LassoLogin</span> object,</p></li>
<li class="listitem"><p>LASSO_PROFILE_ERROR_MISSING_REMOTE_PROVIDERID if <em class="parameter"><code>remote_providerID</code></em> is NULL and no default remote
provider could be found from the server object -- usually the first one in the order of adding to
the server object --,</p></li>
<li class="listitem"><p>LASSO_SERVER_ERROR_PROVIDER_NOT_FOUND if the <em class="parameter"><code>remote_providerID</code></em> is not known to our server object.</p></li>
<li class="listitem"><p>LASSO_PROFILE_ERROR_INVALID_HTTP_METHOD if the HTTP method is neither LASSO_HTTP_METHOD_REDIRECT
or LASSO_HTTP_METHOD_POST,</p></li>
<li class="listitem"><p>LASSO_PROFILE_ERROR_BUILDING_REQUEST_FAILED if creation of the request object failed.</p></li>
</ul></div>

</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" title="lasso_login_init_idp_initiated_authn_request ()">
<a name="lasso-login-init-idp-initiated-authn-request"></a><h3>lasso_login_init_idp_initiated_authn_request ()</h3>
<pre class="programlisting">lasso_error_t       lasso_login_init_idp_initiated_authn_request
                                                        (LassoLogin *login,
                                                         const <a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gchar"
>gchar</a> *remote_providerID);</pre>
<p>
</p>
<p>Generates an authentication response without matching authentication
request.</p>
<p>
</p>
<p>
</p>
<p>The choice of NameIDFormat is the same as for <code class="function">lasso_login_init_authn_request()</code> but with the
target <em class="parameter"><code>remote_providerID</code></em> as the current provider</p>
<p>
</p>
<p>
</p>
<p>If <em class="parameter"><code>remote_providerID</code></em> is NULL, the first known provider is used.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>login</code></em> :</span></p></td>
<td> a <span class="type">LassoLogin</span>.
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>remote_providerID</code></em> :</span></p></td>
<td> the providerID of the remote service provider (may be
     NULL)
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> 0 on success; or a negative value otherwise. Error codes are the same as
<code class="function">lasso_login_init_authn_request()</code>.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" title="lasso_login_init_request ()">
<a name="lasso-login-init-request"></a><h3>lasso_login_init_request ()</h3>
<pre class="programlisting">lasso_error_t       lasso_login_init_request            (LassoLogin *login,
                                                         <a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gchar"
>gchar</a> *response_msg,
                                                         LassoHttpMethod response_http_method);</pre>
<p>
Initializes an artifact request. <em class="parameter"><code>response_msg</code></em> is either the query string
(in redirect mode) or the form LAREQ field (in browser-post mode).
It should only be used if you received an artifact message, <em class="parameter"><code>response_msg</code></em> must be content of the
artifact field for the POST artifact binding of the query string for the REDIRECT artifact
binding. You must set the <em class="parameter"><code>response_http_method</code></em> argument according to the way you received the
artifact message.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>login</code></em> :</span></p></td>
<td> a <span class="type">LassoLogin</span>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>response_msg</code></em> :</span></p></td>
<td> the authentication response received
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>response_http_method</code></em> :</span></p></td>
<td> the method used to receive the authentication
     response
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> 0 on success; or
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>
LASSO_PARAM_ERROR_BAD_TYPE_OR_NULL_OBJ if login is not a <span class="type">LassoLogin</span> object,
</p></li>
<li class="listitem"><p>
LASSO_PARAM_ERROR_INVALID_VALUE if <em class="parameter"><code>response_msg</code></em> is NULL,
</p></li>
<li class="listitem"><p>
LASSO_PROFILE_ERROR_INVALID_HTTP_METHOD if the HTTP method is neither LASSO_HTTP_METHOD_REDIRECT
or LASSO_HTTP_METHOD_POST (in the ID-FF 1.2 case) or neither LASSO_HTTP_METHOD_ARTIFACT_GET or
LASSO_HTTP_METHOD_ARTIFACT_POST (in the SAML 2.0 case),
</p></li>
<li class="listitem"><p>
LASSO_PROFILE_ERROR_MISSING_ARTIFACT if no artifact field was found in the query string (only
possible for the LASSO_HTTP_METHOD_REDIRECT case),
</p></li>
<li class="listitem"><p>
LASSO_PROFILE_ERROR_INVALID_ARTIFACT if decoding of the artifact failed -- whether because
the base64 encoding is invalid or because the type code is wrong --,
</p></li>
<li class="listitem"><p>
LASSO_PROFILE_ERROR_MISSING_REMOTE_PROVIDERID if no provider ID could be found corresponding to
the hash contained in the artifact.
</p></li>
</ul></div>

</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" title="lasso_login_must_ask_for_consent ()">
<a name="lasso-login-must-ask-for-consent"></a><h3>lasso_login_must_ask_for_consent ()</h3>
<pre class="programlisting"><a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gboolean"
>gboolean</a>            lasso_login_must_ask_for_consent    (LassoLogin *login);</pre>
<p>
Evaluates if consent must be asked to the Principal to federate him.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>login</code></em> :</span></p></td>
<td> a <span class="type">LassoLogin</span>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> <code class="literal">TRUE</code> if consent must be asked
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" title="lasso_login_must_authenticate ()">
<a name="lasso-login-must-authenticate"></a><h3>lasso_login_must_authenticate ()</h3>
<pre class="programlisting"><a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gboolean"
>gboolean</a>            lasso_login_must_authenticate       (LassoLogin *login);</pre>
<p>
Evaluates if user must be authenticated.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>login</code></em> :</span></p></td>
<td> a <span class="type">LassoLogin</span>
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> <code class="literal">TRUE</code> if user must be authenticated
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" title="lasso_login_process_authn_request_msg ()">
<a name="lasso-login-process-authn-request-msg"></a><h3>lasso_login_process_authn_request_msg ()</h3>
<pre class="programlisting">lasso_error_t       lasso_login_process_authn_request_msg
                                                        (LassoLogin *login,
                                                         const char *authn_request_msg);</pre>
<p>
Processes received authentication request, checks it is signed correctly,
checks if requested protocol profile is supported, etc.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>login</code></em> :</span></p></td>
<td> a <span class="type">LassoLogin</span>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authn_request_msg</code></em> :</span></p></td>
<td> the authentication request received
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> 0 on success; or
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p>
<span class="type">LASSO_PARAM_ERROR_BAD_TYPE_OR_NULL_OBJ</span> if login is no a <span class="type">LassoLogin</span> object,
</p></li>
<li class="listitem"><p>
<span class="type">LASSO_PROFILE_ERROR_MISSING_REQUEST</span> if <em class="parameter"><code>authn_request_msg</code></em> is <span class="type">NULL</span> and no request as actually
been processed or initialized &amp;<span class="type">151</span>; see <code class="function">lasso_login_init_idp_initiated_authn_request()</code>,

</p></li>
<li class="listitem"><p>
<span class="type">LASSO_PROFILE_ERROR_INVALID_MSG</span> if the content of <em class="parameter"><code>authn_request_msg</code></em> cannot be parsed to as a
valid lib:AuthnRequest messages for any support binding (mainly HTTP-Redirect, HTTP-Post and
SOAP),
</p></li>
<li class="listitem"><p>

<span class="type">LASSO_PROFILE_ERROR_MISSING_ISSUER</span> if the parsed samlp2:AuthnRequest does not have a proper Issuer element,
</p></li>
<li class="listitem"><p>

<span class="type">LASSO_PROFILE_ERROR_INVALID_REQUEST</span> if the parsed message does not validate as a valid
samlp2:AuthnRequest (SAMLv2) i.e. if there is no Issuer, or mutually exclusive attributes are
used (ProtocolBinding and AssertionConsumerServiceIndex),
</p></li>
<li class="listitem"><p>

<span class="type">LASSO_PROFILE_ERROR_INVALID_PROTOCOLPROFILE</span> if the protocolProfile (ID-FFv1.2) or the
protocolBinding (SAMLv2) is unsupported by Lasso,
</p></li>
<li class="listitem"><p>

<span class="type">LASSO_PROFILE_ERROR_UNSUPPORTED_PROFILE</span> if the protocolProfile (ID-FFv1.2) or the protocolBinding
(SAMLv2) for the AssertionConsumer is unsupported by this provider implementation as indicated by
its metadata file,
</p></li>
<li class="listitem"><p>

<span class="type">LASSO_PROFILE_ERROR_UNKNOWN_PROVIDER</span>, or
<span class="type">LASSO_SERVER_ERROR_PROVIDER_NOT_FOUND</span> if the metadata for the issuer of the request are absent
from the <span class="type">LassoServer</span> object of this profile,
</p></li>
<li class="listitem"><p>

<span class="type">LASSO_DS_ERROR_SIGNATURE_NOT_FOUND</span> if no signature could be found and signature validation is
forced &amp;<span class="type">151</span>; by the service provider metadata with the AuthnRequestsSigned attribute
(ID-FFv1.2&amp;SAMLv2), the attribute WantAuthnRequestsSigned in the identity provider metadata file
(SAMLv2) or as advised by the <code class="function">lasso_profile_set_signature_verify_hint()</code> method),
</p></li>
<li class="listitem"><p>

<span class="type">LASSO_DS_ERROR_SIGNATURE_VERIFICATION_FAILED</span> if the signature validation failed on a present
signature,
</p></li>
<li class="listitem"><p>
<span class="type">LASSO_DS_ERROR_INVALID_SIGNATURE</span> if the signature was malformed and a signature was present,
</p></li>
</ul></div>

</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" title="lasso_login_process_authn_response_msg ()">
<a name="lasso-login-process-authn-response-msg"></a><h3>lasso_login_process_authn_response_msg ()</h3>
<pre class="programlisting">lasso_error_t       lasso_login_process_authn_response_msg
                                                        (LassoLogin *login,
                                                         <a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gchar"
>gchar</a> *authn_response_msg);</pre>
<p>
Processes received authentication response.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>login</code></em> :</span></p></td>
<td> a <span class="type">LassoLogin</span>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authn_response_msg</code></em> :</span></p></td>
<td> the authentication response received
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> 0 on success; or a negative value otherwise.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" title="lasso_login_process_paos_response_msg ()">
<a name="lasso-login-process-paos-response-msg"></a><h3>lasso_login_process_paos_response_msg ()</h3>
<pre class="programlisting">lasso_error_t       lasso_login_process_paos_response_msg
                                                        (LassoLogin *login,
                                                         <a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gchar"
>gchar</a> *msg);</pre>
</div>
<hr>
<div class="refsect2" title="lasso_login_process_request_msg ()">
<a name="lasso-login-process-request-msg"></a><h3>lasso_login_process_request_msg ()</h3>
<pre class="programlisting">lasso_error_t       lasso_login_process_request_msg     (LassoLogin *login,
                                                         <a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gchar"
>gchar</a> *request_msg);</pre>
<p>
Processes received artifact request.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>login</code></em> :</span></p></td>
<td> a <span class="type">LassoLogin</span>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>request_msg</code></em> :</span></p></td>
<td> the artifact request received
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> 0 on success; or a negative value otherwise.
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" title="lasso_login_process_response_msg ()">
<a name="lasso-login-process-response-msg"></a><h3>lasso_login_process_response_msg ()</h3>
<pre class="programlisting">lasso_error_t       lasso_login_process_response_msg    (LassoLogin *login,
                                                         <a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gchar"
>gchar</a> *response_msg);</pre>
<p>
Processes received assertion response.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>login</code></em> :</span></p></td>
<td> a <span class="type">LassoLogin</span>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>response_msg</code></em> :</span></p></td>
<td> the assertion response received
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> 0 on success; or
<div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p><span class="type">LASSO_PARAM_ERROR_BAD_TYPE_OR_NULL_OBJ</span> if login is not a <span class="type">LassoLogin</span> object,</p></li>
<li class="listitem"><p><span class="type">LASSO_PARAM_ERROR_INVALID_VALUE</span> if response_msg is NULL,</p></li>
<li class="listitem"><p><span class="type">LASSO_PROFILE_ERROR_INVALID_MSG</span> if the message is not a <span class="type">LassoSamlpResponse</span> (ID-FF 1.2) or a <span class="type">LassoSamlp2ResponseMsg</span> (SAML 2.0),</p></li>
<li class="listitem"><p><span class="type">LASSO_PROFILE_ERROR_RESPONSE_DOES_NOT_MATCH_REQUEST</span> if the response does not refer to the request or if the response refer to an unknown request and <code class="literal">strict-checking</code> is activated ,</p></li>
<li class="listitem"><p><span class="type">LASSO_LOGIN_ERROR_REQUEST_DENIED</span> the identity provided
returned a failure status of "RequestDenied"</p></li>
<li class="listitem"><p><span class="type">LASSO_LOGIN_ERROR_FEDERATION_NOT_FOUND</span> if creation of a new
federation was not allowed and none existed,</p></li>
<li class="listitem"><p><span class="type">LASSO_LOGIN_ERROR_UNKNOWN_PRINCIPAL</span> if authentication failed
or/and if the user cancelled the authentication,</p></li>
<li class="listitem"><p><span class="type">LASSO_LOGIN_ERROR_STATUS_NOT_SUCCESS</span>, if the response status
is a failure but we have no more precise error code to report it, you must
look at the second level status in the response,</p></li>
<li class="listitem"><p><span class="type">LASSO_SERVER_ERROR_PROVIDER_NOT_FOUND</span>, if the issuing
provider of the assertion is unknown,</p></li>
<li class="listitem"><p><span class="type">LASSO_PROFILE_ERROR_INVALID_ISSUER</span> the issuer of the
assertion received, is not the expected one</p></li>
<li class="listitem"><p><span class="type">LASSO_PROFILE_ERROR_NAME_IDENTIFIER_NOT_FOUND</span> no statement was fournd, or none statement contains a subject with a name identifier,</p></li>
<li class="listitem"><p><span class="type">LASSO_PROFILE_ERROR_MISSING_STATUS_CODE</span> if the reponse is
missing a <code class="literal">StatusCode</code> element,</p></li>
<li class="listitem"><p><span class="type">LASSO_PROFILE_ERROR_MISSING_ASSERTION</span> if the message does
not contain any assertion.</p></li>
</ul></div>
</td>
</tr>
</tbody>
</table></div>
</div>
<hr>
<div class="refsect2" title="lasso_login_validate_request_msg ()">
<a name="lasso-login-validate-request-msg"></a><h3>lasso_login_validate_request_msg ()</h3>
<pre class="programlisting">lasso_error_t       lasso_login_validate_request_msg    (LassoLogin *login,
                                                         <a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gboolean"
>gboolean</a> authentication_result,
                                                         <a
href="http://library.gnome.org/devel/glib/unstable/glib-Basic-Types.html#gboolean"
>gboolean</a> is_consent_obtained);</pre>
<p>
Initializes a response to the authentication request received.</p>
<div class="variablelist"><table border="0">
<col align="left" valign="top">
<tbody>
<tr>
<td><p><span class="term"><em class="parameter"><code>login</code></em> :</span></p></td>
<td> a <span class="type">LassoLogin</span>
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>authentication_result</code></em> :</span></p></td>
<td> whether user has authenticated succesfully
</td>
</tr>
<tr>
<td><p><span class="term"><em class="parameter"><code>is_consent_obtained</code></em> :</span></p></td>
<td> whether user consent has been obtained
</td>
</tr>
<tr>
<td><p><span class="term"><span class="emphasis"><em>Returns</em></span> :</span></p></td>
<td> 0 on success; or <div class="itemizedlist"><ul class="itemizedlist" type="disc">
<li class="listitem"><p><span class="type">LASSO_PARAM_ERROR_BAD_TYPE_OR_NULL_OBJ</span> if login is not a <span class="type">LassoLogin</span> object,</p></li>
<li class="listitem">
<p><span class="type">LASSO_LOGIN_ERROR_REQUEST_DENIED</span></p> if <em class="parameter"><code>authentication_result</code></em> if FALSE,</li>
<li class="listitem"><p><span class="type">LASSO_LOGIN_ERROR_INVALID_SIGNATURE</span> if signature validation of the request
failed,</p></li>
<li class="listitem"><p><span class="type">LASSO_LOGIN_ERROR_UNSIGNED_AUTHN_REQUEST</span> if no signature was present on the
request,</p></li>
<li class="listitem"><p><span class="type">LASSO_LOGIN_ERROR_FEDERATION_NOT_FOUND</span> if federation policy is
<span class="type">LASSO_LIB_NAMEID_POLICY_TYPE_NONE</span> and no federation was found in the <span class="type">LassoIdentity</span> object
(ID-FF 1.2 case)</p></li>
<li class="listitem"><p><span class="type">LASSO_LOGIN_ERROR_INVALID_NAMEIDPOLICY</span> if request policy is not one of
<span class="type">LASSO_LIB_NAMEID_POLICY_TYPE_FEDERATED</span> or <span class="type">LASSO_LIB_NAMEID_POLICY_TYPE_ANY</span> (ID-FF 1.2 case) or if no NameID policy was defined or the AllowCreate request flag is FALSE (SAML 2.0 case),</p></li>
<li class="listitem"><p><span class="type">LASSO_LOGIN_ERROR_CONSENT_NOT_OBTAINED</span> if <em class="parameter"><code>is_consent_obtained</code></em> is FALSE and
conssent was necessary (for example if the request does not communicate that consent was already
obtained from the user),</p></li>
<li class="listitem"><p><span class="type">LASSO_SERVER_ERROR_PROVIDER_NOT_FOUND</span> if the requesting provider is unknown,</p></li>
</ul></div>
</td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
<div class="footer">
<hr>
          Generated by GTK-Doc V1.11</div>
</body>
</html>
